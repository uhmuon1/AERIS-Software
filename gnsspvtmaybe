#include <stdio.h>
#include "pico/stdlib.h"
#include "hardware/i2c.h"

#define GNSS_ADDR 0x42

int main() {
    stdio_init_all();
    sleep_ms(2000);
    
    printf("\nI2C Test Program\n");
    printf("--------------\n");
    
    // Initialize I2C
    i2c_init(i2c_default, 100 * 1000);
    gpio_set_function(PICO_DEFAULT_I2C_SDA_PIN, GPIO_FUNC_I2C);
    gpio_set_function(PICO_DEFAULT_I2C_SCL_PIN, GPIO_FUNC_I2C);
    gpio_pull_up(PICO_DEFAULT_I2C_SDA_PIN);
    gpio_pull_up(PICO_DEFAULT_I2C_SCL_PIN);
    
    printf("I2C Initialized\n\n");
    
    // Test reading one byte
    uint8_t byte;
    
    while(1) {
        int result = i2c_read_blocking(i2c_default, GNSS_ADDR, &byte, 1, false);
        printf("Read result: %d, Byte: 0x%02X\n", result, byte);
        sleep_ms(1000);
    }
    
    return 0;
}
